{
  "name":"carCardSearchView",
  "type":"search",
  "title":"充值查询",
  "data":"tbl_car_topup",
  "fields":[
    {
      "name":"departmentId",
      "label":"安装队",
      "type":"select",
      "option":{
        "provider":"defaultOptionProvider",
        "parameter":{
          "key":"_id",
          "value":"name",
          "query":{
            "_data":"tbl_department"
          }
        }
      }
    },
    {
      "name":"carId",
      "label":"车牌号",
      "type":"select",
      "option":{
        "provider":"defaultOptionProvider",
        "parameter":{
          "key":"_id",
          "value":"carNo",
          "query":{
            "_data":"tbl_car"
          },
          "depends":[
            {
              "depend":"departmentId",
              "name":"departmentId"
            }
          ]
        }
      }
    },
    {
      "name":"$total",
      "label":"本年度充值金额",
      "type":"select",
      "tip":"单位(元)",
      "default":false,
      "container":{
        "span":6,
        "label":4,
        "widget":8
      },
      "option":{
        "provider":"totalAmountOptionProvider",
        "parameter":{
          "key":"amount",
          "value":"amount",
          "query":{
            "_data":"none",
            "year":0
          },
          "depends":[
            {
              "depend":"carId",
              "name":"carId"
            }
          ]
        }
      }
    },
    {
      "name":"$lastYearTotal",
      "label":"上年度累计充值",
      "type":"select",
      "tip":"单位(元)",
      "default":false,
      "container":{
        "span":6,
        "label":4,
        "widget":8
      },
      "option":{
        "provider":"totalAmountOptionProvider",
        "parameter":{
          "key":"amount",
          "value":"amount",
          "query":{
            "_data":"none",
            "year":-1
          },
          "depends":[
            {
              "depend":"carId",
              "name":"carId"
            }
          ]
        }
      }
    }
  ],
  "actions":[
    {
      "name":"search",
      "label":"查询",
      "style":"btn-primary",
      "search":true
    },
    {
      "name":"add",
      "label":"充值申请",
      "view":"carCardCreateView",
      "type":"create"
    }
  ],
  "change":[
    {
      "name":"departmentId",
      "target":"carId"
    },
    {
      "name":"carId",
      "target":"$total"
    },
    {
      "name":"carId",
      "target":"$lastYearTotal"
    }
  ],
  "result":[
    {
      "name":"departmentId",
      "label":"安装队",
      "converter":{
        "provider":"dataConverter",
        "parameter":{
          "table":"tbl_department",
          "column":"name"
        }
      }
    },
    {
      "name":"carId",
      "label":"车牌号",
      "converter":{
        "provider":"dataConverter",
        "parameter":{
          "table":"tbl_car",
          "column":"carNo"
        }
      }
    },
    {
      "name":"cardNo",
      "label":"油卡编号"
    },
    {
      "name":"amount",
      "label":"充值金额"
    },
    {
      "name":"requestUser",
      "label":"申请人"
    },
    {
      "name":"requestDate",
      "label":"申请时间",
      "converter":{
        "provider":"dateConverter"
      }
    },
    {
      "name":"status",
      "label":"审核状态"
    }
  ],
  "operate":[
    {
      "name":"查看",
      "icon":"glyphicon-eye-open",
      "view":"carCardCreateView",
      "type":"create"
    },
    {
      "name":"通过",
      "icon":"glyphicon-ok",
      "depend":"status",
      "value":"待审核",
      "change":"carId",
      "operate":true,
      "provider":"carApproveOperateProvider",
      "refresh":"carCardSearchView"
    },
    {
      "name":"拒绝",
      "icon":"glyphicon-remove",
      "confirm":"是否拒绝申请？",
      "depend":"status",
      "value":"待审核",
      "change":"carId",
      "operate":true,
      "provider":"carRejectOperateProvider",
      "refresh":"carCardSearchView"
    },
    {
      "name":"删除",
      "icon":"glyphicon-trash",
      "confirm":"是否确认删除？",
      "operate":true,
      "provider":"deleteOperateProvider",
      "refresh":"carCardSearchView"
    }
  ]
}